---
layout: note
tags: elliptic_curve elliptic_curve_model
---

Let $$By^2=x^3+Ax^2+x$$ be a Montgomery curve, its $$3$$-division
polynomial is

$$\begin{equation}
  3x^4+4Ax^3+6x^2-1.
\end{equation}$$

It follows that for any $$s\in\FF_q$$ the Montgomery curve with

$$\begin{equation}
A = \frac{1-6s^2-3s^4}{4s^3}
\end{equation}$$

has points of order $$3$$ in 

$$\begin{equation}
\left(s,\pm \frac{s^2-1}{2\sqrt{Bs}}\right).
\end{equation}$$

Notice that the points need not be rational. Following
\cite{defeo+jao+plut12} we obtain by VÃ©lu's formulas an expression
for the $$3$$-isogeny with kernel generated by these points.

$$\begin{equation}
\begin{aligned}
\phi : E &\to E/G,\\
(x,y) &\mapsto \left(
\frac{x(xs - 1)^2}{(x-s)^2},\;
y\frac{(xs-1)\left((xs-1)(x-s)+2x(1-s^2)\right)}{(x-s)^3}
\right),
\end{aligned}
\end{equation}$$

and the curve $$E/G$$ has equation

$$\begin{equation*}
E/G \;:\; Bs^2y^2 = x^3 + \left(A+\frac{6}{s}-6s\right)s^2x^2 + x.
\end{equation*}$$

The abscissas of the remaining $$3$$-torsion points are the roots of
the polynomial

$$\begin{equation}
3x^3 + (3s+4A)x^2 + (3s^2+4As+6)x + (3s^3 + 4As^2 + 6s),
\end{equation}$$

call them $$s_0,s_1,s_2$$. The image of these points under $$\phi$$
lies in a cyclic subgroup of $$E/G$$ of order $$3$$, and this subgroup
is the kernel of the dual isogeny $$\hat{\phi}$$. By some long Sage
computation I haven't been able to simplify yet, it turns out that
this subgroup is generated by a point of $$E/G$$ with abscissa

$$\begin{equation}
s_0s_1s_2 = \frac{3s^3 + 4As^2 + 6s}{3} = -\frac{1}{3s}.
\end{equation}$$

Hence, by the same formula as above, the dual isogeny $$\hat{\phi}$$
is defined by

$$\begin{equation}
\begin{aligned}
\phi : E/G &\to \tilde{E},\\
(x,y) &\mapsto \left(
\frac{x(x + 3s)^2}{(3sx+1)^2},\;
y\frac{(x+3s)\left((x+3s)(3sx+1)-2x(9s^2-1)\right)}{(3sx+1)^3}
\right),
\end{aligned}
\end{equation}$$

and the curve $$\tilde{E}$$ has equation

$$\begin{equation*}
\tilde{E} \;:\; \frac{B}{9}y^2 = x^3 + Ax^2 + x
\end{equation*}$$

and is isomorphic to $$E$$ by the change of variables $$y\mapsto y/3$$.
By composing the two isogenies, we obtain a tripling formula on
$$E$$. This formula is especially interesting in XZ
coordinates. Indeed, if $$(X,Z)$$ is a point on (the Kummer line of)
$$E$$, setting

$$\begin{equation}
\begin{aligned}
X_1 &= X(Xs-Z)^2\\
Z_1 &= Z(X-sZ)^2\\
X_2 &= X_1(X_1+3sZ_1)^2\\
Z_2 &= Z_1(X_13s+Z_1)^2
\end{aligned}
\end{equation}$$

the point $$(X_2,Z_2)$$ is three times the point $$(X,Z)$$. This
formula uses $$4M+4S+4c$$, where $$M$$ are multiplications, $$S$$ are
squarings, and $$c$$ are multiplications by (small) constants (either
$$s$$ or $$3s$$). By comparison, the classic tripling on Montgomery
curves requires one doubling and one differential addition, for a
total cost of $$6M+4S+1c$$.

I haven't been able to obtain nice tripling formulas neither in
usual projective coordinates, nor in "Jacobian coordinates"
($$x=X/Z^2, y=Y/Z^3$$).

The question is: what now? This formula is only good when
multiplications by constants cost significantly less than
multiplications by arbitrary field elments. This is not the case,
for example, in \cite{defeo+jao+plut12}, which would be the most
obvious application.

Classic multi-base tricks do not seem to apply nicely to Montgomery
ladders. Indeed, in multi-base systems one seeks to minimize the
number non-zero bits in the addition chain, so to reduce the number
of "add" steps. But in classic Montgomery ladders, every bit
requires the same amount of work, so it seems unlikely that using a
multi-base system may improve anything. Consider the following
attempt to define a Montgomery ladder using triplings. Store the
pair $$([k]P, [k+1]P)$$; at each iteration, compute one of the
following:

- $$([3k]P, [3k+1]P)$$ by one tripling and two differential additions ($$[k,k+1]$$ and $$[2k+1,k]$$);
- $$([3k+1]P, [3k+2]P)$$ by three differential additions ($$[k,k+1]$$, $$[2k+1,k]$$ and $$[2k+1,k+1]$$);
- $$([3k+2]P, [3k+3]P)$$ by two differential additions ($$[k,k+1]$$ and $$[2k+1,k+1]$$) and one tripling;

The first and the third choice cost $$12M+8S$$, the second costs
$$12M+6S$$; this is to compare with a classic binary ladder, where
every step costs $$6M+4S$$. The gain in number of steps in the
ternary case is of $$\log_32\sim0.63$$: not enough to compensate for
the larger cost of every single step. And there goes SCA resistance
too!

